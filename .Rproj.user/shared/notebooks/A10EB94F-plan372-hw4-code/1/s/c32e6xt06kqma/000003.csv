"0",""
"0","# Get the census data with variables that may correlate to air traffic."
"0","census_data <- get_acs("
"0","  geography = ""cbsa"","
"0","  variables = c("
"0","    ""B01003_001"",  # Total population"
"0","    ""B19013_001"",  # Median household income"
"0","    ""B19301_001"",  # Per capita income"
"0","    ""B25077_001""   # Median home value"
"0","  ),"
"0","  year = 2021,"
"0",")"
"2","Getting data from the 2017-2021 5-year ACS
"
"0","# Make it so that every CBSA is a single row with separate columns for each variable"
"0","census_data_wide <- census_data %>%"
"0","  select(GEOID, variable, estimate) %>%"
"0","  pivot_wider(names_from = variable, values_from = estimate) # Source: the tidyr documentation"
"0",""
"0","# Rename the columns"
"0","colnames(census_data_wide) <- c(""cbsa"", ""population"", ""median_income"", ""per_capita_income"", ""median_home_value"")"
"0",""
"0","# Rename columns for origin data"
"0","origin_census <- census_data_wide %>%"
"0","  rename("
"0","    origin_cbsa = cbsa,"
"0","    origin_population = population,"
"0","    origin_median_income = median_income,"
"0","    origin_per_capita_income = per_capita_income,"
"0","    origin_median_home_value = median_home_value"
"0","  )"
"0",""
"0","# Rename columns for destination data"
"0","dest_census <- census_data_wide %>%"
"0","  rename("
"0","    dest_cbsa = cbsa,"
"0","    dest_population = population,"
"0","    dest_median_income = median_income,"
"0","    dest_per_capita_income = per_capita_income,"
"0","    dest_median_home_value = median_home_value"
"0","  )"
"0",""
"0","# Solve conflicting types"
"0","data <- data %>%"
"0","  mutate("
"0","    origin_cbsa = as.character(origin_cbsa),"
"0","    dest_cbsa = as.character(dest_cbsa)"
"0","  )"
"0",""
"0","# Join origin and destination census data to original airplane data"
"0","airport_with_census <- data %>%"
"0","  left_join(origin_census, by = ""origin_cbsa"") %>%"
"0","  left_join(dest_census, by = ""dest_cbsa"")"
"0",""
"0","# Create a new dataset that shows CBSA to CBSA volumes and not airport-to-airport"
"0","cbsa_to_cbsa <- airport_with_census %>%"
"0","  group_by(origin_cbsa, dest_cbsa, origin_population, dest_population,"
"0","           origin_median_income, dest_median_income,"
"0","           origin_per_capita_income, dest_per_capita_income,"
"0","           origin_median_home_value, dest_median_home_value, distancemiles) %>%"
"0","  summarize(total_passengers = sum(passengers, na.rm = TRUE)) %>%"
"0","  ungroup()"
"2","`summarise()` has grouped output by 'origin_cbsa', 'dest_cbsa', 'origin_population', 'dest_population', 'origin_median_income', 'dest_median_income', 'origin_per_capita_income', 'dest_per_capita_income', 'origin_median_home_value', 'dest_median_home_value'. You can override using the `.groups` argument."
"0","# Scatter plot of origin population and total passengers"
"0","ggplot(cbsa_to_cbsa, aes(x = origin_population, y = total_passengers)) +"
"0","  geom_point() +"
"0","  labs(title = ""Origin Population and Total Passengers"", x = ""Origin Population"", y = ""Total Passengers"")+"
"0","   scale_y_continuous(labels = label_number()) + # Source: https://www.geeksforgeeks.org/change-formatting-of-numbers-of-ggplot2-plot-axis-in-r/"
"0","  scale_x_continuous(labels = label_number()) "
